<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìŒì•… ì·¨í–¥ ê¸°ë°˜ ì»¤í”¼ ì¶”ì²œ</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="top">
    <h1>ìŒì•… ì·¨í–¥ ê¸°ë°˜ ì»¤í”¼ ì¶”ì²œ</h1>
    <p>5ë¬¸í•­ìœ¼ë¡œ ì˜¤ëŠ˜ì˜ ì»¤í”¼ë¥¼ ì¶”ì²œí•´ì¤„ê²Œ! â˜•</p>
  </header>

  <main class="wrap">
    <section class="card" id="quiz">
      <h2>ì·¨í–¥ ì…ë ¥</h2>

      <form id="musicForm">
        <!-- Q1 -->
        <fieldset>
          <legend>Q1. ì„ í˜¸í•˜ëŠ” ìŒì•… ì¥ë¥´ê°€ ë­ì•¼?ğŸ§ </legend>
          <label><input type="radio" name="genre" value="jazz" required> Jazz/Classic</label>
          <label><input type="radio" name="genre" value="lofi"> Lo-fi/Indie</label>
          <label><input type="radio" name="genre" value="hiphop"> Hip-hop/Rock</label>
          <label><input type="radio" name="genre" value="edm"> EDM/Pop</label>
        </fieldset>

        <!-- Q2 -->
        <fieldset>
          <legend>Q2. ì–´ë–¨ ë•Œ ì£¼ë¡œ ë“¤ì–´?â˜•</legend>
          <label><input type="radio" name="mood" value="study" required> ì§‘ì¤‘ëª¨ë“œ (ê³¼ì œ/ê³µë¶€)</label>
          <label><input type="radio" name="mood" value="exercise"> ëª¸ì„ í’€ê³  ì‹¶ë‹¤! (ì‚°ì±…/ìš´ë™)</label>
          <label><input type="radio" name="mood" value="night"> ìƒˆë²½ ê°ì„± íƒ€ì„..</label>
          <label><input type="radio" name="mood" value="talk"> ì¹´í˜ì—ì„œ í† í¬í† í¬</label>
        </fieldset>

        <!-- Q3 -->
        <fieldset>
          <legend>Q3. ì„ í˜¸í•˜ëŠ” ìŒë£Œ ë°”ë””ê°ì„ ìŠ¬ë¼ì´ë“œë°” ê°€ë²¼ì›€(0) ~ ê¾¸ë•í•¨ (100) ìœ¼ë¡œ í‘œí˜„í•´ì¤˜!ğŸ§‹ </legend>
          <div class="rangeRow">
            <input type="range" id="heavy" name="heavy" min="0" max="100" value="50">
            <span id="heavyVal">50</span>
          </div>
        </fieldset>

        <!-- Q4 -->
        <fieldset>
          <legend>Q4. ì‚°ë¯¸(ìƒí¼í•¨) ì¢‹ì•„í•´?ğŸŠ</legend>
          <label><input type="radio" name="acid" value="like" required> ì¢‹ì•„!</label>
          <label><input type="radio" name="acid" value="ok"> ë‚«ë±ƒ</label>
          <label><input type="radio" name="acid" value="hate"> ì‹«ì–´! </label>
        </fieldset>

        <!-- Q5 -->
        <fieldset>
          <legend>Q5. ìš°ìœ  ë“¤ì–´ê°„ ì»¤í”¼(ë¼ë–¼ë¥˜)ğŸ¥› ì–´ë•Œ? </legend>
          <label><input type="radio" name="milk" value="like" required> ì¢‹ì•„</label>
          <label><input type="radio" name="milk" value="ok"> ìƒê´€ì—†ìŒ</label>
          <label><input type="radio" name="milk" value="hate"> ì‹«ì–´</label>
        </fieldset>

        <button class="btn" type="submit">ì¶”ì²œ ë°›ê¸°</button>
      </form>
    </section>

    <section class="card" id="result" style="display:none">
      <h2 id="coffeeName">â˜• ì˜¤ëŠ˜ì˜ ì¶”ì²œ:</h2>
      <div id="reason"></div>

      <div class="grid">
        <div>
          <h3>ë‚´ ì»¤í”¼ ì·¨í–¥ í”„ë¡œí•„</h3>
          <div class="small" id="profileText"></div>
        </div>
        <div>
          <h3>ì·¨í–¥ í•œëˆˆì— ë³´ê¸° ğŸ“Š</h3>
          <canvas id="chart" width="320" height="220"></canvas>
        </div>
      </div>

      <div class="row">
        <button class="btn ghost" id="retry" type="button">ğŸ”„ ë‹¤ì‹œ í•´ë³¼ë˜?</button>
      </div>
    </section>
  </main>

  <footer class="foot">
    <small>Rule-based MVP Â· DOM/Event/Canvas ì‚¬ìš©</small>
  </footer>

<script>
const coffees = [
  { name:"í•¸ë“œë“œë¦½ğŸŒ¿â˜•", acidity:5, body:2, sweet:2, caffeine:2 },
  { name:"ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ğŸ§Šâ˜•", acidity:3, body:2, sweet:1, caffeine:3 },
  { name:"ì½œë“œë¸Œë£¨ğŸ§Šâš¡", acidity:2, body:4, sweet:2, caffeine:4 },
  { name:"í”Œë«í™”ì´íŠ¸ğŸ¥›â˜•", acidity:1, body:3, sweet:3, caffeine:2 },
  { name:"ëª¨ì¹´ğŸ«â˜•", acidity:1, body:4, sweet:5, caffeine:3 }
];

const form = document.getElementById("musicForm");
const heavy = document.getElementById("heavy");
const heavyVal = document.getElementById("heavyVal");

heavy.addEventListener("input", e => heavyVal.innerText = e.target.value);

function clamp(v){ return Math.max(0, Math.min(5, v)); }
function dist(u,c){
  return Math.abs(u.acidity-c.acidity)
       + Math.abs(u.body-c.body)
       + Math.abs(u.sweet-c.sweet)
       + Math.abs(u.caffeine-c.caffeine);
}

form.addEventListener("submit", function(e){
  e.preventDefault();

  const genre = form.genre.value;
  const mood  = form.mood.value;
  const hv    = parseInt(form.heavy.value, 10);
  const acid  = form.acid.value;
  const milk  = form.milk.value;

  let user = { acidity:0, body:0, sweet:0, caffeine:0 };
  let reasons = [];

  // Q1
  if(genre==="jazz"){ user.acidity+=2; user.body+=1; reasons.push("ì„¬ì„¸í•˜ê³  ê¹Šì€ ìŒì•…ì„ ì¢‹ì•„í•˜ëŠ” ê²ƒ ê°™ì•„ì„œ, ì›ë‘ì—ì„œë„ í–¥ê³¼ ì‚°ë¯¸ë¥¼ ìŒë¯¸í•´ ë³¼ ìˆ˜ ìˆëŠ” ì»¤í”¼ë¥¼ ê³¨ë¼ë´¤ì–´!"); }
  if(genre==="lofi"){ user.sweet+=1; user.body+=1; reasons.push("ë¶€ë“œëŸ½ê²Œ íë¥´ëŠ” ìŒì•…ì„ ì¢‹ì•„í•œë‹¤ë©´, ì»¤í”¼ë„ ë¶€ë“œëŸ¬ìš´ ìš°ìœ  ë² ì´ìŠ¤ì˜ ë‹¬ì½¤í•œ ë§›ì´ ì…ì— í¸ì•ˆí•˜ê²Œ ì˜ ë§ì„ê±°ì•¼!."); }
  if(genre==="hiphop"){ user.body+=2; user.caffeine+=1; reasons.push("ì„¼ ë¹„íŠ¸ì˜ ìŒì•…ì„ ì¢‹ì•„í•œë‹¤ë©´ ì»¤í”¼ë„ ë¬µì§í•˜ê²Œ ë°”ë””ê° ìˆëŠ” ì»¤í”¼ë¥¼ ë§ˆì…”ë³´ìã…ã…"); }
  if(genre==="edm"){ user.caffeine+=2; user.acidity+=1; reasons.push("ì‹ ë‚˜ëŠ” ìŒì•… ì·¨í–¥ì—” ì»¤í”¼ë„ ì¹´í˜ì¸ìœ¼ë¡œ ë„íŒŒë¯¼ ì±„ì›Œë³´ì!"); }

  // Q2
  if(mood==="study"){ user.caffeine+=2; reasons.push("ğŸ“šì§‘ì¤‘ì´ í•„ìš”í•œ ìƒí™©ì´ë¼ ì¹´í˜ì¸ ìª½ì— ë” ì¤‘ì ì„ ë‘¬ë´¤ì–´!"); }
  if(mood==="exercise"){ user.caffeine+=2; user.body+=1; reasons.push("ğŸƒâ€â™€ï¸ëª¸ì„ ì›€ì§ì¼ ë• ê°ì„±ê°ì´ ì‚´ì•„ìˆëŠ” ì»¤í”¼ê°€ ì¢‹ì§€")}
  if(mood==="night"){ user.body+=2; reasons.push("ğŸŒ™ í˜¼ì ì”ì”íˆ ë“£ëŠ” ì‹œê°„ëŒ€ì—” ë¬µì§í•œ ì—¬ìš´ì´ ì¢‹ì•„")}
  if(mood==="talk"){ user.sweet+=2; reasons.push("ğŸ—£ï¸ê°€ë³ê²Œ ì¦ê¸°ëŠ” ìë¦¬ì—” ë¶€ë“œëŸ½ê³  ë‹¬ì½¤í•œ ìª½ì´ ë”± ë§ì•„")}

  // Q3 (0~100 -> body 0~3)
  user.body += Math.floor(hv/34);
  if (hv >= 67) {
  reasons.push("ğŸ§‹ ê¾¸ë•ê¾¸ë• ì§„í•œ ëŠë‚Œì„ ì¢‹ì•„í•´ì„œ, ë°”ë””ê° ìˆëŠ” ìª½ìœ¼ë¡œ ê¸°ìš¸ì˜€ì–´!");
} else if (hv <= 33) {
  reasons.push("ğŸ’§ê°€ë³ê²Œ ë§ˆì‹œëŠ” ìŠ¤íƒ€ì¼ì´ë¼, ê¹”ë”í•œ ìª½ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë´¤ì–´!");
} else {
  reasons.push("â˜• ë„ˆë¬´ ê°€ë³ì§€ë„ ì§„í•˜ì§€ë„ ì•Šê²Œ ë¬´ë‚œí•œ ì •ë„ë¡œ ê³¨ë¼ë´¤ì–´!");
}

  // Q4
  if(acid==="like"){ user.acidity+=2; }
  if(acid==="ok"){ user.acidity+=1; }
  if(acid==="hate"){ user.acidity-=1; user.sweet+=1; reasons.push("ì‚°ë¯¸ë¥¼ ì‹«ì–´í•´í•˜ê¸¸ë˜ ë‹¨ë§› ìª½ìœ¼ë¡œ ë°¸ëŸ°ìŠ¤ë¥¼ ë§ì·„ì–´!"); }

  // Q5
  if(milk==="like"){ user.sweet+=1; user.body+=1; }
  if(milk==="hate"){ user.sweet-=1; user.acidity+=1; reasons.push("ìš°ìœ  ë² ì´ìŠ¤ë¥¼ ì‹«ì–´í•´ì„œ ë” ê¹”ë”í•œ ìª½ìœ¼ë¡œ ë³´ì •í–ˆì–´!"); }

  // clamp
  user.acidity = clamp(user.acidity);
  user.body    = clamp(user.body);
  user.sweet   = clamp(user.sweet);
  user.caffeine= clamp(user.caffeine);

  // pick best
  let best = coffees[0], bestD = dist(user, best);
  for(let i=1;i<coffees.length;i++){
    const d = dist(user, coffees[i]);
    if(d<bestD){ bestD=d; best=coffees[i]; }
  }

  // DOM output
  document.getElementById("coffeeName").innerText = `ì˜¤ëŠ˜ì˜ ì¶”ì²œ: ${best.name}`;
  document.getElementById("reason").innerHTML =
  reasons.slice(0,3).map(s => `â€¢ ${s}`).join("<br>");
  document.getElementById("profileText").innerText =
    `ì‚°ë¯¸ğŸŠ${user.acidity}/5 Â· ë°”ë””ğŸ§‹ ${user.body}/5 Â· ë‹¨ë§›ğŸ¯ ${user.sweet}/5 Â· ì¹´í˜ì¸âš¡ ${user.caffeine}/5`;

  document.getElementById("result").style.display = "block";

  // canvas chart
  const canvas = document.getElementById("chart");
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const labels = ["ì‚°ë¯¸","ë°”ë””","ë‹¨ë§›","ì¹´í˜ì¸"];
  const vals = [user.acidity,user.body,user.sweet,user.caffeine];

  for(let i=0;i<4;i++){
    const x = 40 + i*70;
    const h = vals[i]*30;
    ctx.fillStyle = "#7b4b2a"; 
  ctx.fillRect(x, 180-h, 30, h);

  ctx.fillStyle = "#2f1d12";  
  ctx.fillText(labels[i], x-5, 205);
}
});

document.getElementById("retry").addEventListener("click", ()=>{
  document.getElementById("result").style.display="none";
  form.reset();
  heavyVal.innerText = "50";
});
</script>
</body>
</html>
